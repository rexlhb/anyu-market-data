(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2623:function(e,s,t){Promise.resolve().then(t.bind(t,1974))},1974:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return i}});var a=t(4341),n=t(9593),c=t(2987);function l(e){let{category:s,unit:t,icon:n,prices:c}=e,l=c.find(e=>"全国均价"===e.province),i=c.filter(e=>"全国均价"!==e.province),r=e=>0===e?"text-black":e>0?"text-red-600":"text-anyou-dark",x=e=>0===e?"−":e>0?"↑":"↓",d=e=>"玉米"===s||"豆粕"===s?e.toFixed(0):e.toFixed(2),m=(null==l?void 0:l.price)||(i.length>0?i.reduce((e,s)=>e+s.price,0)/i.length:0),o=(null==l?void 0:l.change_amount)||0,h=(null==l?void 0:l.change_percent)||0;return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-anyou to-anyou-dark px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-3xl",children:n}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-white text-lg font-bold",children:s}),(0,a.jsxs)("p",{className:"text-white/80 text-xs",children:[l?"全国均价":"".concat(i.length,"个重点省份")," \xb7 ",t]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsx)("p",{className:"text-white text-2xl font-bold",children:d(m)}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)("span",{className:"text-sm ".concat(r(o).replace("text-","text-white/")),children:x(o)}),(0,a.jsxs)("span",{className:"text-xs ml-1 ".concat(r(o).replace("text-","text-white/")),children:[o>=0?"+":"",o.toFixed(2)," (",h>=0?"+":"",h.toFixed(2),"%)"]})]})]})]})}),(0,a.jsx)("div",{className:"px-4 py-3",children:0===i.length?(0,a.jsxs)("div",{className:"flex flex-col items-center py-4",children:[(0,a.jsx)("span",{className:"text-4xl",children:"⚠️"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"暂无数据"})]}):(0,a.jsx)("div",{className:"space-y-2",children:i.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-base",children:"\uD83D\uDCCD"}),(0,a.jsx)("span",{className:"text-gray-900 ml-2",children:e.province})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-900 font-medium text-base mr-3",children:d(e.price)}),(0,a.jsxs)("div",{className:"flex items-center min-w-16",children:[(0,a.jsx)("span",{className:"text-sm ".concat(r(e.change_amount)),children:x(e.change_amount)}),(0,a.jsxs)("span",{className:"text-xs ml-1 ".concat(r(e.change_amount)),children:[e.change_amount&&e.change_amount>=0?"+":"",(e.change_amount||0).toFixed(2)]})]})]})]},"".concat(s,"-").concat(e.province)))})})]})}function i(){let[e,s]=(0,n.useState)([]),[t,i]=(0,n.useState)(!0),[r,x]=(0,n.useState)(!1),[d,m]=(0,n.useState)(""),[o,h]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e="true"===new URLSearchParams(window.location.search).get("refresh");j(e),e&&window.history.replaceState({},"","/")},[]);let j=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{i(!0);let t=await fetch("/api/prices".concat(e?"?realtime=true":"")),a=await t.json();a.data&&(s(a.data),m(a.date),h(a.date),p(a.realtime))}catch(e){console.error("加载价格数据失败:",e)}finally{i(!1)}},N=async()=>{try{x(!0);let e=await fetch("/api/scrape",{method:"POST"}),s=await e.json();s.success?console.log("数据采集成功，正在加载最新数据..."):console.warn("数据采集失败，将使用已有数据:",s.error),await j(!0)}catch(e){console.error("刷新失败:",e)}finally{x(!1)}},g=c.a.map(s=>{let t=e.filter(e=>e.category===s.name);return{...s,prices:t}});return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-anyou to-anyou-dark px-4 pt-8 pb-6",children:(0,a.jsxs)("div",{className:"max-w-lg mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("img",{src:"/logo.png",alt:"安佑LOGO",className:"w-12 h-12 object-contain"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{onClick:N,disabled:r,className:"flex items-center px-3 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg transition-colors disabled:opacity-50",children:r?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):(0,a.jsx)("span",{className:"text-white text-sm",children:"\uD83D\uDD04 刷新"})}),u&&(0,a.jsx)("div",{className:"px-2 py-1 bg-green-500/30 rounded-full",children:(0,a.jsx)("span",{className:"text-white text-xs",children:"\uD83D\uDD34 实时"})}),(0,a.jsx)("p",{className:"text-white/70 text-xs",children:"每日9:00自动更新"})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-white text-2xl font-bold",children:"每日行情"}),(0,a.jsx)("p",{className:"text-white/90 text-sm mt-2",children:"Market Briefing"}),e.length>0&&(0,a.jsx)("div",{className:"mt-3 bg-white/20 rounded-lg px-4 py-2 inline-block",children:(0,a.jsxs)("p",{className:"text-white text-sm",children:["数据日期：",d," (",e.length,"条)"]})})]})]})}),(0,a.jsx)("div",{className:"px-4 py-4",children:(0,a.jsx)("div",{className:"max-w-lg mx-auto space-y-4",children:t?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-anyou border-t-transparent"}),(0,a.jsx)("p",{className:"text-gray-500 mt-4",children:"加载中..."})]}):0===e.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20",children:[(0,a.jsx)("span",{className:"text-5xl",children:"\uD83D\uDCCA"}),(0,a.jsx)("p",{className:"text-gray-500 mt-4",children:"暂无数据"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:"数据将在每天早上9:00自动更新"})]}):g.map(e=>(0,a.jsx)(l,{category:e.name,unit:e.unit,icon:e.icon,prices:e.prices},e.name))})}),(0,a.jsx)("div",{className:"px-4 pb-24 pt-4",children:(0,a.jsxs)("div",{className:"max-w-lg mx-auto bg-white rounded-xl p-4 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("span",{className:"text-lg text-anyou-dark",children:"ℹ️"}),(0,a.jsx)("h3",{className:"text-gray-900 font-medium ml-2",children:"数据说明"})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm leading-relaxed mb-3",children:"数据来源于博亚和讯、猪好多网、玄田数据等专业畜牧网站，通过联网搜索实时获取。价格仅供参考，实际交易请以当地市场为准。"}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-3 space-y-2",children:[(0,a.jsxs)("p",{className:"text-gray-600 text-xs leading-relaxed",children:[(0,a.jsx)("span",{className:"font-medium",children:"更新规则："}),"每日上午9:00自动更新当天数据。9:00之前显示前一天数据，9:00之后显示当天数据。"]}),(0,a.jsxs)("p",{className:"text-gray-600 text-xs leading-relaxed",children:[(0,a.jsx)("span",{className:"font-medium",children:"实时数据："}),'点击"\uD83D\uDD04 刷新"按钮可获取最新的实时价格数据，数据来源：三大网站综合搜索']})]})]})}),(0,a.jsx)("div",{className:"px-4 pb-24",children:(0,a.jsx)("div",{className:"max-w-lg mx-auto bg-anyou-light/20 rounded-xl p-4",children:(0,a.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:"一个专业化、自动化、可视化的畜牧饲料原料市场行情信息平台，旨在为畜牧养殖户、饲料生产企业从业者、行业分析师等用户提供实时、准确的市场行情数据和服务。安佑集团预混料事业部市场部发布。"})})})]})}},2987:function(e,s,t){"use strict";t.d(s,{a:function(){return a}});let a=[{name:"生猪",unit:"元/公斤",icon:"\uD83D\uDC37"},{name:"仔猪",unit:"元/公斤",icon:"\uD83D\uDC16"},{name:"鸡蛋",unit:"元/公斤",icon:"\uD83E\uDD5A"},{name:"淘汰鸡",unit:"元/公斤",icon:"\uD83D\uDC13"},{name:"玉米",unit:"元/吨",icon:"\uD83C\uDF3D"},{name:"豆粕",unit:"元/吨",icon:"\uD83E\uDED8"}]}},function(e){e.O(0,[665,298,744],function(){return e(e.s=2623)}),_N_E=e.O()}]);