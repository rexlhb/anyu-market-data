# 超简单部署指南 - 大白话版

## 总共只需要5步，10分钟搞定！

---

## 第1步：把代码上传到GitHub（3分钟）

### 1.1 注册GitHub账号（如果没有）
1. 打开 https://github.com/
2. 点击右上角 "Sign up" 注册账号
3. 注册完成后登录

### 1.2 创建新仓库
1. 点击右上角 "+" 号，选择 "New repository"
2. Repository name 输入：`anyu-market-data`
3. Public / Private 选择 **Public**（必须选Public才能免费）
4. 点击 "Create repository"

### 1.3 上传代码
创建仓库后，你会看到一个页面，选择 "uploading an existing file"：

**方法A：网页上传（推荐，最简单）**
1. 点击 "uploading an existing file" 链接
2. 把 `clean-deploy` 文件夹里的所有文件拖进去
3. 拖进去的文件会自动带上传路径
4. 滚到最下面，绿色按钮 "Commit changes"

**方法B：使用Git命令（如果你会用）**
```bash
cd clean-deploy
git init
git add .
git commit -m "初始提交"
git branch -M main
git remote add origin https://github.com/你的用户名/anyu-market-data.git
git push -u origin main
```

---

## 第2步：测试GitHub Actions（3分钟）

### 2.1 进入Actions页面
1. 在GitHub仓库页面，点击顶部的 "Actions" 标签
2. 你会看到 "Daily Data Collection" 工作流

### 2.2 手动触发一次测试
1. 点击左侧 "Daily Data Collection"
2. 点击右侧 "Run workflow" 按钮
3. 点击绿色的 "Run workflow" 按钮确认

### 2.3 查看运行结果
1. 等待1-2分钟，工作流会自动运行
2. 点击运行的任务查看详情
3. 展开各个步骤，看是否都打勾 ✅

**如果失败了**：
- 点击失败的步骤，查看错误信息
- 常见问题：权限问题、依赖安装失败

---

## 第3步：连接前端和数据（2分钟）

现在有两种方案让前端显示数据，我推荐**方案A**（更简单）。

### 方案A：前端直接读取JSON（推荐）

修改前端HTML文件，让它直接读取JSON数据：

**打开** `clean-deploy/anyu-netlify-deploy/index.html`

找到显示数据的地方，添加这段JavaScript代码（在 `<head>` 里）：

```html
<script>
// 从GitHub读取数据
async function loadMarketData() {
  try {
    const response = await fetch('https://raw.githubusercontent.com/你的用户名/anyu-market-data/main/backend/market_data.json');
    const data = await response.json();
    
    // 更新页面上的数据
    updatePageWithNewData(data);
  } catch (error) {
    console.error('加载数据失败:', error);
  }
}

// 页面加载时获取数据
document.addEventListener('DOMContentLoaded', loadMarketData);
</script>
```

**记得把 `你的用户名` 改成你自己的GitHub用户名！**

### 方案B：使用Netlify Functions（稍复杂）

如果你更喜欢后端渲染，可以配置Netlify Functions读取数据。

---

## 第4步：部署到Netlify（2分钟）

### 4.1 注册Netlify（如果没有）
1. 打开 https://www.netlify.com/
2. 点击 "Sign up" 注册
3. 选择 "Sign up with GitHub"（最方便）

### 4.2 部署网站
1. 登录后，点击 "Add new site" → "Import an existing project"
2. 选择 "GitHub"（需要授权）
3. 选择你的 `anyu-market-data` 仓库
4. Build settings 设置：
   - **Base directory**: `clean-deploy/anyu-netlify-deploy`
   - **Publish directory**: `.`（当前目录）
   - **Build command**: 留空（静态网站不需要构建）
5. 点击 "Deploy site"

### 4.3 获取网站地址
部署完成后，Netlify会给你一个随机网址，比如：
```
https://happy-pudding-12345.netlify.app
```

你可以点击 "Site settings" → "Change site name" 修改成自己喜欢的名字。

---

## 第5步：验证自动运行（明天早上9:00）

### 5.1 检查定时任务
GitHub Actions会在每天北京时间 **上午9:00** 自动运行。

### 5.2 验证数据更新
1. 第二天早上9:10左右，打开你的网站
2. 查看数据是否更新了
3. 也可以去GitHub的Actions页面查看运行记录

### 5.3 如果没自动运行
可能是时区问题，打开 `clean-deploy/.github/workflows/daily-data-collection.yml`：

```yaml
schedule:
  # 尝试不同的时间（UTC时间，北京时间 = UTC+8）
  - cron: '0 1 * * *'  # 北京时间9:00
```

修改后提交代码，第二天再观察。

---

## 常见问题

### Q1: GitHub Actions 失败怎么办？
**A:**
1. 查看失败步骤的错误信息
2. 常见原因：
   - `coze-coding-ai` 命令不存在 → 需要修改脚本，使用备用数据
   - 权限问题 → 检查仓库设置 "Actions" → "General" → "Workflow permissions"

### Q2: 网站显示的数据没更新？
**A:**
1. 检查JSON文件是否更新：访问 `https://raw.githubusercontent.com/你的用户名/anyu-market-data/main/backend/market_data.json`
2. 刷新浏览器页面（Ctrl+F5 强制刷新）
3. 检查前端JavaScript代码的路径是否正确

### Q3: GitHub Actions 每天运行次数不够？
**A:**
GitHub免费版每月2000分钟，每天运行一次完全够用（每月约30分钟）。

### Q4: 网站访问速度慢？
**A:**
- Netlify的免费版已经很快了
- 如果在国内访问慢，可以考虑使用国内CDN（如阿里云、腾讯云）

---

## 数据采集说明

当前数据采集脚本使用了 `coze-coding-ai` 命令进行联网搜索。

**如果GitHub Actions中这个命令不可用**，系统会自动使用备用数据：

| 品类 | 备用价格 | 数据来源 |
|-----|---------|---------|
| 生猪 | 12.73元/公斤 | 备用数据 |
| 仔猪 | 19.72元/公斤 | 备用数据 |
| 鸡蛋 | 7.35元/公斤 | 生意社备用 |
| 淘汰鸡 | 9.20元/公斤 | 鸡病专业网备用 |
| 玉米 | 2285元/吨 | 港口价格备用 |
| 豆粕 | 2727元/吨 | 备用数据 |

**注意**：备用数据仅供参考，实际生产环境建议配置真实的API接口。

---

## 维护建议

系统配置完成后，基本免维护：

✅ **每周检查一次**：去GitHub Actions页面查看运行记录
✅ **每月查看一次**：检查免费额度使用情况
✅ **定期备份数据**：可以下载market_data.json保存历史数据

---

## 下一步优化方向

如果你想让系统更完善，可以考虑：

1. **真实数据源**：配置博亚和讯、猪好多网的API接口
2. **数据对比**：显示不同数据源的价格对比
3. **历史趋势图**：使用图表库显示价格走势
4. **预警通知**：价格涨跌超过阈值时发送邮件通知

---

## 完成啦！

恭喜你完成了自动化部署！从今往后，每天早上9:00，系统会自动：

1. 从网络采集最新价格数据
2. 保存到GitHub仓库
3. 更新到你的网站

你只需要每天打开网站就能看到最新数据了！🎉

---

**祝你使用愉快！**

有任何问题随时问哦~
