<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的 - 安佑预混料</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "San Francisco", "Roboto", "Helvetica Neue", Arial, sans-serif;
            background-color: #ffffff;
            color: #333333;
            padding: 15px 10px;
            line-height: 1.4;
        }

        /* 顶部信息区 */
        .header {
            margin-bottom: 25px;
        }

        /* 顶部栏容器核心样式 */
        .header-bar {
            width: 100%;
            height: 80px;
            background-color: #8BC34A; /* 浅黄绿色背景 */
            border-radius: 12px 0 0 12px; /* 左上、左下圆角12px，右侧直角 */
            padding: 15px;
            box-sizing: border-box; /* 内边距计入宽高 */
            display: flex; /* Flex布局实现水平排列 */
            align-items: center; /* 垂直居中 */
            justify-content: space-between; /* 子元素两端分布 */
            position: relative; /* 用于定位底部数据区 */
            overflow: hidden; /* 防止内容溢出 */
        }

        /* Logo区域 */
        .header-logo {
            width: 40px;
            height: 40px;
            margin-right: 20px;
            flex-shrink: 0;
        }
        .header-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* 保持Logo比例 */
        }

        /* 中间标题区域 */
        .header-title {
            text-align: center;
            color: #FFFFFF; /* 白色文字 */
            flex: 1; /* 占满剩余空间，实现居中 */
        }
        .main-title {
            font-size: 20px;
            font-weight: bold;
            margin: 0;
            line-height: 1.2;
        }
        .sub-title {
            font-size: 14px;
            margin: 5px 0 0 0;
            line-height: 1.2;
        }

        /* 右侧信息区域 */
        .header-info {
            color: #FFFFFF; /* 白色文字 */
            text-align: right;
            flex-shrink: 0;
        }
        .date-text {
            font-size: 14px;
            margin: 0;
        }
        .update-text {
            font-size: 12px;
            margin: 3px 0 0 0;
        }

        /* 功能模块 */
        .function-section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 16px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 15px;
        }

        /* 文档下载区域 */
        .download-card {
            background-color: #ffffff;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .download-info {
            flex: 1;
        }

        .download-title {
            font-size: 15px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 5px;
        }

        .download-desc {
            font-size: 13px;
            color: #666666;
        }

        .download-btn {
            background-color: #8BC34A;
            color: #ffffff;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 13px;
            cursor: pointer;
            white-space: nowrap;
        }

        .download-btn:hover {
            background-color: #7CB342;
        }

        /* 功能说明区域 */
        .info-card {
            background-color: #f8f8f8;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .info-title {
            font-size: 15px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 10px;
        }

        .info-text {
            font-size: 13px;
            color: #666666;
            line-height: 1.6;
        }

        /* 关于我们区域 */
        .about-card {
            background-color: #ffffff;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .about-title {
            font-size: 15px;
            font-weight: bold;
            color: #333333;
            margin-bottom: 10px;
        }

        .about-text {
            font-size: 13px;
            color: #666666;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        /* 底部导航栏 */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 15px 0;
            border-top: 1px solid #e5e5e5;
            position: sticky;
            bottom: 0;
            background-color: #ffffff;
        }

        .nav-item {
            text-align: center;
            flex: 1;
        }

        .nav-item span {
            font-size: 14px;
            color: #333333;
            font-weight: normal;
        }

        .nav-item.active span {
            color: #8BC34A;
            font-weight: bold;
        }

        /* 响应式适配 - 手机端竖屏单列布局 */
        @media (max-width: 374px) {
            body {
                padding: 15px 10px;
            }

            /* 顶部栏响应式调整 */
            .header-bar {
                height: 100px;
                padding: 10px;
            }

            .header-logo {
                width: 35px;
                height: 35px;
                margin-right: 10px;
            }

            .main-title {
                font-size: 18px;
            }

            .sub-title {
                font-size: 12px;
            }

            .header-info {
                margin-left: auto;
            }

            .date-text {
                font-size: 12px;
            }

            .update-text {
                font-size: 10px;
            }

            .section-title {
                font-size: 15px;
            }

            .download-card {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .download-btn {
                width: 100%;
            }

            .download-title {
                font-size: 14px;
            }

            .download-desc {
                font-size: 12px;
            }

            .info-title {
                font-size: 14px;
            }

            .info-text {
                font-size: 12px;
            }

            .about-title {
                font-size: 14px;
            }

            .about-text {
                font-size: 12px;
            }

            .bottom-nav {
                padding: 12px 0;
            }

            .nav-item span {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部栏模块 -->
    <div class="header">
        <div class="header-bar">
            <!-- Logo区域 -->
            <div class="header-logo">
                <img src="out/安佑心科技LOGO.png" alt="安佑心科技LOGO">
            </div>

            <!-- 中间标题区域 -->
            <div class="header-title">
                <h1 class="main-title">我的</h1>
                <p class="sub-title">Profile</p>
            </div>

            <!-- 右侧信息区域 -->
            <div class="header-info">
                <p class="date-text">2026-01-14</p>
                <p class="update-text">个人中心</p>
            </div>
        </div>
    </div>

    <!-- 功能模块 -->
    <div class="function-section">
        <h2 class="section-title">文档下载</h2>

        <div class="download-card">
            <div class="download-info">
                <div class="download-title">本周行情数据</div>
                <div class="download-desc">本周六大品类（生猪、仔猪、鸡蛋、淘汰鸡、玉米、豆粕）行情数据</div>
            </div>
            <button class="download-btn">下载</button>
        </div>

        <div class="download-card">
            <div class="download-info">
                <div class="download-title">每周周报</div>
                <div class="download-desc">本周行情分析及下周市场预测</div>
            </div>
            <button class="download-btn">下载</button>
        </div>
    </div>

    <!-- 功能说明 -->
    <div class="function-section">
        <h2 class="section-title">功能说明</h2>

        <div class="info-card">
            <div class="info-title">每日行情</div>
            <div class="info-text">
                实时展示生猪、仔猪、鸡蛋、淘汰鸡、玉米、豆粕等6大品类每日行情数据，覆盖全国12个重点省份，数据每日上午9:00自动更新。
            </div>
        </div>

        <div class="info-card">
            <div class="info-title">每周周报</div>
            <div class="info-text">
                每周一更新上周市场总结，涵盖各品类价格变化、市场分析、趋势预测等专业内容，为用户提供全面的市场决策参考。
            </div>
        </div>
    </div>

    <!-- 关于我们 -->
    <div class="function-section">
        <h2 class="section-title">关于我们</h2>

        <div class="about-card">
            <div class="about-title">平台介绍</div>
            <div class="about-text">
                安佑预混料行情平台是安佑集团预混料事业部推出的专业化、自动化、可视化市场行情信息平台，旨在为畜牧养殖户、饲料生产企业从业者、行业分析师等用户提供实时、准确的市场行情数据和服务。
            </div>
            <div class="about-text">
                数据来源：博亚和讯、猪好多网、玄田数据等专业畜牧网站
            </div>
            <div class="about-text">
                发布单位：安佑集团预混料事业部市场部
            </div>
        </div>
    </div>

    <!-- 底部导航栏 -->
    <div class="bottom-nav">
        <div class="nav-item">
            <a href="index.html" style="text-decoration: none;">
                <span>每日行情</span>
            </a>
        </div>
        <div class="nav-item">
            <a href="weekly-report.html" style="text-decoration: none;">
                <span>每周周报</span>
            </a>
        </div>
        <div class="nav-item active">
            <span>我的</span>
        </div>
    </div>

    <script>
        // 配置：GitHub用户名（请修改为你的GitHub用户名）
        const GITHUB_USERNAME = 'rexlhb';
        const REPO_NAME = 'anyu-market-data';

        // 从GitHub获取周报索引
        async function fetchWeeklyReportIndex() {
            try {
                const url = `https://cdn.jsdelivr.net/gh/${GITHUB_USERNAME}/${REPO_NAME}@main/backend/weekly_report_index.json`;
                const response = await fetch(url);

                if (!response.ok) {
                    console.warn('未找到周报索引文件');
                    return null;
                }

                const data = await response.json();
                return data;
            } catch (error) {
                console.error('获取周报索引失败:', error);
                return null;
            }
        }

        // 下载文档（从GitHub下载）
        async function downloadDocument(githubPath, filename) {
            try {
                const url = `https://cdn.jsdelivr.net/gh/${GITHUB_USERNAME}/${REPO_NAME}@main/backend/market_history.json`;
                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`下载失败: ${response.status}`);
                }

                // 获取文件内容
                const blob = await response.blob();

                // 创建下载链接
                const urlObj = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = urlObj;
                link.download = filename;
                link.style.display = 'none';

                // 触发下载
                document.body.appendChild(link);
                link.click();

                // 清理
                document.body.removeChild(link);
                window.URL.revokeObjectURL(urlObj);

                console.log(`文档下载成功: ${filename}`);
            } catch (error) {
                console.error('文档下载失败:', error);
                alert(`文档下载失败: ${error.message}\\n\\n请稍后重试，或联系管理员检查GitHub仓库中的文件。`);
            }
        }

        // 初始化下载按钮
        async function initDownloadButtons() {
            const reportIndex = await fetchWeeklyReportIndex();
            const buttons = document.querySelectorAll('.download-btn');

            if (!reportIndex || !reportIndex.latest) {
                console.warn('未找到可下载的周报');
                buttons.forEach(btn => {
                    btn.disabled = true;
                    btn.textContent = '暂无周报';
                });
                return;
            }

            const latestReport = reportIndex.latest;

            // 第一个按钮：下载Excel
            if (buttons[0]) {
                buttons[0].addEventListener('click', async () => {
                    console.log(`开始下载: ${latestReport.excel}`);
                    await downloadDocument(`backend/${latestReport.excel}`, latestReport.excel);
                });
                buttons[0].textContent = '下载 Excel';
            }

            // 第二个按钮：下载TXT
            if (buttons[1]) {
                buttons[1].addEventListener('click', async () => {
                    console.log(`开始下载: ${latestReport.txt}`);
                    await downloadDocument(`backend/${latestReport.txt}`, latestReport.txt);
                });
                buttons[1].textContent = '下载 周报';
            }

            // 更新描述信息
            const weekRange = `${latestReport.week_start} 至 ${latestReport.week_end}`;
            const descs = document.querySelectorAll('.download-desc');
            if (descs[0]) {
                descs[0].textContent = `本周六大品类（生猪、仔猪、鸡蛋、淘汰鸡、玉米、豆粕）行情数据 (${weekRange})`;
            }
            if (descs[1]) {
                descs[1].textContent = `本周行情分析及下周市场预测 (${weekRange})`;
            }
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            initDownloadButtons();
        });
    </script>
</body>
</html>
